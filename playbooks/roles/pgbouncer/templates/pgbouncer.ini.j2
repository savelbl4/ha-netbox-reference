[databases]
{% for dbname, db in pgb_databases.items() %}
{{ dbname }}{{ ' = ' }}
{%- for k, v in db.params.items() -%}
{{ k }}{{ '=' }}{{ v }}{{ '\n' if loop.last else ' ' }}
{%- endfor %}
{% endfor %}

[pgbouncer]
listen_addr = {{ pgb_listen_addr }}
listen_port = {{ pgb_listen_port }}

pidfile = {{ pgb_pidfile }}
{#logfile = {{ pgb_logfile }}#}
syslog = 1

auth_type = {{ pgb_auth_type }}
auth_file = {{ pgb_auth_file }}
{% if pgb_auth_query|length > 0 %}auth_query = {{ pgb_auth_query }}{% endif %}
{% if pgb_auth_user|length > 0 %}auth_user = {{ pgb_auth_user }}{% endif %}

pool_mode = {{ pgb_pool_mode }}
max_client_conn = {{ pgb_max_client_conn }}
default_pool_size = {{ pgb_default_pool_size }}
min_pool_size = {{ pgb_min_pool_size }}
reserve_pool_size = {{ pgb_reserve_pool_size }}
reserve_pool_timeout = {{ pgb_reserve_pool_timeout }}

server_reset_query = {{ pgb_server_reset_query }}
server_login_retry = 5
query_timeout = {{ pgb_query_timeout }}
query_wait_timeout = {{ pgb_query_wait_timeout }}
idle_transaction_timeout = {{ pgb_idle_xact_timeout }}
server_idle_timeout = {{ pgb_server_idle_timeout }}

ignore_startup_parameters = extra_float_digits

admin_users = {{ pgb_admin_users }}
stats_users = {{ pgb_stats_users }}

; SSL можно включить при необходимости:
; client_tls_sslmode = disable
; server_tls_sslmode = prefer
